(()=>{"use strict";function e(e,t,n){let a=document.createElement(`${e}`);return a.className=`${t}`,a.innerHTML=`${n}`,a}const t=["C","D","E","F","G","A","B","Em","Am","Dm"];var n=[],a="",o=[];function s(){document.getElementById("content").innerHTML=""}const r=document.getElementById("content");function i(){document.body.style.backgroundImage="url(../src/assets/images/background.jpg)";let a=e("div","grid-container","");r.appendChild(a),function(){n=[];for(let a=0;a<t.length;a++){let o=e("button","grid-item",t[a]);n.push(o)}}(),n.forEach((e=>{a.appendChild(e),e.addEventListener("click",(function(){var t=new Audio;t.src=`../src/assets/sounds/${e.textContent}.wav`,t.addEventListener("canplaythrough",(function(){this.play()}))}))}))}function d(){document.body.style.backgroundImage="url(../src/assets/images/practice.png)",s(),function(){a="",o=[];let n=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}(t).slice(0,4);for(let t=0;t<n.length;t++){let a=e("button","",n[t]);o.push(a)}a=n[Math.floor(Math.random()*n.length)]}();let n=e("div","flex-container","");var i=new Audio;i.src=`../src/assets/sounds/${a}.wav`,i.addEventListener("canplaythrough",(function(){this.play()}));let c=e("div","flex-top",`<button id=${a} data-chord=${a}>Repeat Chord</button>\n      <button id="refresh">Refresh</button>\n    `);n.append(c);let l=e("div","results",""),p=e("div","flex-bottom","");n.appendChild(p),o.forEach((e=>{e.addEventListener("click",(function(){e.textContent===a?(l.classList.remove("wrong"),l.classList.add("correct"),l.textContent="Thats right!",setTimeout((()=>{d()}),1e3)):(l.classList.add("wrong"),l.classList.remove("correct"),l.textContent="That's wrong! Try Again.")})),p.appendChild(e),p.appendChild(l)})),r.appendChild(n),document.getElementById(a).addEventListener("click",(function(){var e=new Audio;e.src=`../src/assets/sounds/${a}.wav`,e.addEventListener("canplaythrough",(function(){this.play()}))})),document.getElementById("refresh").addEventListener("click",(function(){d()}))}async function c(t){const n=t.currentTarget.dataset.songId,a=t.currentTarget.dataset.songName,o=t.currentTarget.dataset.songArtist,i=t.currentTarget.dataset.songImageUrl;var d,c;await(d=n,c=localStorage.getItem("access_token"),new Promise(((e,t)=>{fetch(`https://api.spotify.com/v1/audio-features/${d}`,{method:"GET",headers:{Authorization:`Bearer ${c}`}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((t=>{localStorage.setItem("tempo",Math.round(t.tempo)),localStorage.setItem("time_signature",t.time_signature),e(t)})).catch((e=>{console.error("Error searching Spotify:",e),t(e)}))}))),console.log("songSearch.js",localStorage.getItem("tempo")+" "+localStorage.getItem("time_signature")),s(),function(t,n,a,o,s){const i=e("div","metronome-container",""),d=e("div","metronome",""),c=e("div","bpm-display",""),l=e("span","tempo",o),p=e("span","bpm","BPM"),u=e("div","song-details",""),m=document.createElement("img");m.src=a,m.alt="Song Album Cover";const g=e("div","tempo-text",`${t} - ${n}`),h=e("div","tempo-settings",""),f=e("div","adjust-tempo-btn decrease-tempo","-"),v=e("input","slider");v.type="range",v.min="20",v.max="280",v.step="1";const y=e("div","adjust-tempo-btn increase-tempo","+"),C=e("div","measures",""),E=e("div","subtract-beats stepper","-"),b=e("div","measure-count",s),k=e("div","add-beats stepper","+"),I=e("div","choice-div",""),T=e("div","start-stop","START"),S=e("div","select-song","SELECT ANOTHER SONG");c.appendChild(l),c.appendChild(p),u.appendChild(m),u.appendChild(g),h.appendChild(f),h.appendChild(v),h.appendChild(y),C.appendChild(E),C.appendChild(b),C.appendChild(k),I.appendChild(T),I.appendChild(S),d.appendChild(c),d.appendChild(u),d.appendChild(h),d.appendChild(C),d.appendChild(I),i.appendChild(d),r.appendChild(i)}(a,o,i,localStorage.getItem("tempo"),localStorage.getItem("time_signature"))}function l(e){const t=document.querySelector(".autocomplete-results");if(""!=e.target.value&&8!=e.keyCode||""!=e.target.value&&8==e.keyCode){!function(e,t){const n=[],a=`https://api.spotify.com/v1/search?q=${encodeURIComponent(e)}&type=track`;fetch(a,{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then((function(e){if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((function(e){for(let t=0;t<e.tracks.items.length;t++)n.push({id:e.tracks.items[t].id,name:e.tracks.items[t].name,artist:e.tracks.items[0].artists[0].name,image:e.tracks.items[t].album.images[0].url});localStorage.setItem("songsArray",JSON.stringify(n))})).catch((function(e){console.error("Error searching Spotify:",e)}))}(e.target.value,localStorage.getItem("access_token")),t.innerHTML="";const n=JSON.parse(localStorage.getItem("songsArray"))||[];for(let e=0;e<n.length;e++){const a=document.createElement("li");a.dataset.songName=n[e].name,a.dataset.songArtist=n[e].artist,a.dataset.songImageUrl=n[e].image,a.dataset.songId=n[e].id,a.innerHTML=`\n            <img src="${n[e].image}" alt="album image">\n            <div class="list-detail">\n                <div class="top">\n                    <h4>${n[e].name}</h4>\n                </div>\n                <div class="bottom">\n                    <h5>${n[e].artist}</h5>\n                </div>\n            </div>\n        `,a.addEventListener("click",c),t.appendChild(a)}}else(null==e.target.value||""==e.target.value&&8==e.keyCode)&&(t.innerHTML="",autoList.innerHTML="")}const p=document.getElementById("home-btn"),u=document.getElementById("practice-btn"),m=document.getElementById("metronome-btn");s(),i(),p.addEventListener("click",(()=>{s(),i()})),u.addEventListener("click",(()=>{s(),function(){document.body.style.backgroundImage="url(../src/assets/images/practice.png)";let t=e("div","flex-container","");const n=e("button","start-practice-btn","START");n.addEventListener("click",d),t.appendChild(n),r.appendChild(t)}()})),m.addEventListener("click",(()=>{fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=client_credentials&client_id=96fd8f0b535344928da701ea7025bcfa&client_secret=78aa06cc5c08438a900f68a07fde2170"}).then((function(e){return e.json()})).then((function(e){const t=e.access_token;return localStorage.setItem("access_token",t),t})).catch((function(e){console.error("Error getting access token:",e)})),s(),function(){s(),document.body.style.backgroundImage="url(../src/assets/images/metronome.jpg)",s();let t=e("div","search-container",""),n=document.createElement("input");n.setAttribute("type","text"),n.id="search-input",n.setAttribute("placeholder","Search for a song..."),n.setAttribute("autocomplete","off");let a=e("ul","autocomplete-results","");t.appendChild(n),t.appendChild(a),r.appendChild(t)}(),document.getElementById("search-input").addEventListener("keyup",l)}))})();