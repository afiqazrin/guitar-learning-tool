(()=>{"use strict";function e(e,t,n){let o=document.createElement(`${e}`);return o.className=`${t}`,o.innerHTML=`${n}`,o}const t=["C","D","E","F","G","A","B","Em","Am","Dm"];var n=[],o="",a=[];function r(){document.getElementById("content").innerHTML=""}async function c(t){const n=t.currentTarget.dataset.songId,o=t.currentTarget.dataset.songName,a=t.currentTarget.dataset.songArtist,c=t.currentTarget.dataset.songImageUrl;var s,i;await(s=n,i=localStorage.getItem("access_token"),new Promise(((e,t)=>{fetch(`https://api.spotify.com/v1/audio-features/${s}`,{method:"GET",headers:{Authorization:`Bearer ${i}`}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((t=>{localStorage.setItem("tempo",Math.round(t.tempo)),localStorage.setItem("time_signature",t.time_signature),e(t)})).catch((e=>{console.error("Error searching Spotify:",e),t(e)}))}))),console.log("songSearch.js",localStorage.getItem("tempo")+" "+localStorage.getItem("time_signature")),r(),function(t,n,o,a,r){const c=e("div","metronome-container",""),s=e("div","metronome",""),i=e("div","bpm-display",""),d=e("span","tempo",a),l=e("span","bpm","BPM"),u=e("div","song-details",""),m=document.createElement("img");m.src=o,m.alt="Song Album Cover";const C=e("div","tempo-text",`${t} - ${n}`),S=e("div","tempo-settings",""),I=e("div","adjust-tempo-btn decrease-tempo","-"),b=e("input","slider");b.type="range",b.min="20",b.max="280",b.step="1",b.value=a;const k=e("div","adjust-tempo-btn increase-tempo","+");b.addEventListener("input",h),I.addEventListener("click",p),k.addEventListener("click",g);const T=e("div","measures",""),L=e("div","subtract-beats stepper","-");L.addEventListener("click",v);const x=e("div","measure-count",r),A=e("div","add-beats stepper","+");A.addEventListener("click",f);const $=e("div","choice-div",""),_=e("div","start-stop","START");_.addEventListener("click",y);const q=e("div","select-song","SELECT ANOTHER SONG");q.addEventListener("click",w),i.appendChild(d),i.appendChild(l),u.appendChild(m),u.appendChild(C),S.appendChild(I),S.appendChild(b),S.appendChild(k),T.appendChild(L),T.appendChild(x),T.appendChild(A),$.appendChild(_),$.appendChild(q),s.appendChild(i),s.appendChild(u),s.appendChild(S),s.appendChild(T),s.appendChild($),c.appendChild(s),E.appendChild(c)}(o,a,c,localStorage.getItem("tempo"),localStorage.getItem("time_signature"))}function s(e){const t=document.querySelector(".autocomplete-results");if(""!=e.target.value&&8!=e.keyCode||""!=e.target.value&&8==e.keyCode){!function(e,t){const n=[],o=`https://api.spotify.com/v1/search?q=${encodeURIComponent(e)}&type=track`;fetch(o,{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then((function(e){if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((function(e){for(let t=0;t<e.tracks.items.length;t++)n.push({id:e.tracks.items[t].id,name:e.tracks.items[t].name,artist:e.tracks.items[0].artists[0].name,image:e.tracks.items[t].album.images[0].url});localStorage.setItem("songsArray",JSON.stringify(n))})).catch((function(e){console.error("Error searching Spotify:",e)}))}(e.target.value,localStorage.getItem("access_token")),t.innerHTML="";const n=JSON.parse(localStorage.getItem("songsArray"))||[];for(let e=0;e<n.length;e++){const o=document.createElement("li");o.dataset.songName=n[e].name,o.dataset.songArtist=n[e].artist,o.dataset.songImageUrl=n[e].image,o.dataset.songId=n[e].id,o.innerHTML=`\n            <img src="${n[e].image}" alt="album image">\n            <div class="list-detail">\n                <div class="top">\n                    <h4>${n[e].name}</h4>\n                </div>\n                <div class="bottom">\n                    <h5>${n[e].artist}</h5>\n                </div>\n            </div>\n        `,o.addEventListener("click",c),t.appendChild(o)}}else(null==e.target.value||""==e.target.value&&8==e.keyCode)&&(localStorage.removeItem("songsArray"),t.innerHTML="")}const i=new Audio("../src/assets/sounds/Synth_Block_A_hi.wav"),d=new Audio("../src/assets/sounds/Synth_Block_A_lo.wav");let l,u=0,m=!1;function p(){const e=document.querySelector(".tempo"),t=document.querySelector(".slider");let n=e.textContent;n<=20||(n--,e.textContent=n,t.value=n,window.clearInterval(l),l=window.setInterval((function(){C()}),6e4/n))}function g(){const e=document.querySelector(".tempo"),t=document.querySelector(".slider");let n=e.textContent;n>=280||(n++,e.textContent=n,t.value=n,window.clearInterval(l),l=window.setInterval((function(){C()}),6e4/n))}function h(){const e=document.querySelector(".tempo"),t=document.querySelector(".slider");let n=t.value;e.textContent=n,t.value=n,window.clearInterval(l),l=window.setInterval((function(){C()}),6e4/n)}function v(){const e=document.querySelector(".tempo"),t=(document.querySelector(".subtract-beats"),document.querySelector(".measure-count"));let n=t.textContent,o=e.textContent;n<=2||(n--,t.textContent=n,window.clearInterval(l),l=window.setInterval((function(){C()}),6e4/o))}function f(){const e=document.querySelector(".tempo"),t=(document.querySelector(".add-beats"),document.querySelector(".measure-count"));let n=t.textContent,o=e.textContent;n>=12||(n++,t.textContent=n,window.clearInterval(l),l=window.setInterval((function(){C()}),6e4/o))}function y(){let e=document.querySelector(".tempo").textContent;console.log("bpm "+e),m?(window.clearInterval(l),console.log("stopping"),m=!1,this.textContent="START"):(l=window.setInterval((function(){C()}),6e4/e),m=!0,this.textContent="STOP")}function C(){console.log(u);let e=document.querySelector(".measure-count").textContent;console.log(e),u==e&&(u=0),0==u?(i.play(),i.currentTime=0):(d.play(),d.currentTime=0),u++}function w(){window.clearInterval(l),r(),b(),document.getElementById("search-input").addEventListener("keyup",s)}const E=document.getElementById("content");function S(){document.body.style.backgroundImage="url(../src/assets/images/background.jpg)";let o=e("div","grid-container","");E.appendChild(o),function(){n=[];for(let o=0;o<t.length;o++){let a=e("button","grid-item",t[o]);n.push(a)}}(),n.forEach((e=>{o.appendChild(e),e.addEventListener("click",(function(){var t=new Audio;t.src=`../src/assets/sounds/${e.textContent}.wav`,t.addEventListener("canplaythrough",(function(){this.play()}))}))}))}function I(){document.body.style.backgroundImage="url(../src/assets/images/practice.png)",r(),function(){o="",a=[];let n=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}(t).slice(0,4);for(let t=0;t<n.length;t++){let o=e("button","",n[t]);a.push(o)}o=n[Math.floor(Math.random()*n.length)]}();let n=e("div","flex-container","");var c=new Audio;c.src=`../src/assets/sounds/${o}.wav`,c.addEventListener("canplaythrough",(function(){this.play()}));let s=e("div","flex-top",`<button id=${o} data-chord=${o}>Repeat Chord</button>\n      <button id="refresh">Refresh</button>\n    `);n.append(s);let i=e("div","results",""),d=e("div","flex-bottom","");n.appendChild(d),a.forEach((e=>{e.addEventListener("click",(function(){e.textContent===o?(i.classList.remove("wrong"),i.classList.add("correct"),i.textContent="Thats right!",setTimeout((()=>{I()}),1e3)):(i.classList.add("wrong"),i.classList.remove("correct"),i.textContent="That's wrong! Try Again.")})),d.appendChild(e),d.appendChild(i)})),E.appendChild(n),document.getElementById(o).addEventListener("click",(function(){var e=new Audio;e.src=`../src/assets/sounds/${o}.wav`,e.addEventListener("canplaythrough",(function(){this.play()}))})),document.getElementById("refresh").addEventListener("click",(function(){I()}))}function b(){r(),document.body.style.backgroundImage="url(../src/assets/images/metronome.jpg)",r();let t=e("div","search-container",""),n=document.createElement("input");n.setAttribute("type","text"),n.id="search-input",n.setAttribute("placeholder","Search for a song..."),n.setAttribute("autocomplete","off");let o=e("ul","autocomplete-results","");t.appendChild(n),t.appendChild(o),E.appendChild(t)}const k=document.getElementById("home-btn"),T=document.getElementById("practice-btn"),L=document.getElementById("metronome-btn");r(),S(),k.addEventListener("click",(()=>{r(),S()})),T.addEventListener("click",(()=>{r(),function(){document.body.style.backgroundImage="url(../src/assets/images/practice.png)";let t=e("div","flex-container","");const n=e("button","start-practice-btn","START");n.addEventListener("click",I),t.appendChild(n),E.appendChild(t)}()})),L.addEventListener("click",(()=>{fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=client_credentials&client_id=96fd8f0b535344928da701ea7025bcfa&client_secret=78aa06cc5c08438a900f68a07fde2170"}).then((function(e){return e.json()})).then((function(e){const t=e.access_token;return localStorage.setItem("access_token",t),t})).catch((function(e){console.error("Error getting access token:",e)})),r(),b(),document.getElementById("search-input").addEventListener("keyup",s)}))})();